@model PgManagerApp.Models.UserRegistration
<title>Admin Task Assignment</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
    .kanban-board {
        display: flex;
        gap: 1rem;
    }

    .kanban-column {
        width: 32%;
        padding: 1rem;
        border-radius: 8px;
        background: #fff;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .task-card {
        background-color: #e0e0e0;
        padding: 1rem;
        border-radius: 8px;
        cursor: pointer;
        margin-bottom: 1rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .kanban-header {
        font-weight: bold;
        margin-bottom: 1rem;
    }

    .create-task-btn {
        margin-bottom: 20px;
    }
</style>
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center">
        <h2 class="text-center mb-0">Task Board</h2>
        <button class="btn btn-primary create-task-btn" id="createTaskButton">
            <i class="fas fa-plus"></i> Create Task
        </button>
    </div>
    <br />
    <div class="kanban-board">
        <div class="kanban-column" id="todo">
            <div class="kanban-header">To Do</div>
        </div>
        <div class="kanban-column" id="inprogress">
            <div class="kanban-header">In Progress</div>
        </div>
        <div class="kanban-column" id="complete">
            <div class="kanban-header">Complete</div>
        </div>
    </div>
</div>

<!-- Modal for Task Assignment -->
<div class="modal fade" id="taskModal" tabindex="-1" aria-labelledby="taskModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="taskModalLabel">Assign Task</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="taskForm">
                    <div class="form-group">
                        <label for="project">Project</label>
                        <select class="form-control" id="project" required>
                            <option>Project 1</option>
                            <option>Project 2</option>
                            <option>Project 3</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="assignedBy">Assigned By</label>
                        <input type="text" class="form-control" id="assignedBy" required>
                    </div>
                    <div class="form-group">
                        <label for="assignedTo">Assigned To</label>
                        <select class="form-control" id="assignedTo" required>
                            <option>User 1 - Developer</option>
                            <option>User 2 - Designer</option>
                            <option>User 3 - Manager</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="taskDescription">Task Description</label>
                        <textarea class="form-control" id="taskDescription" rows="3" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="priority">Select Priority</label>
                        <select class="form-control" id="priority" required>
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="status">Status</label>
                        <select class="form-control" id="status" required>
                            <option value="todo">To Do</option>
                            <option value="inprogress">In Progress</option>
                            <option value="complete">Complete</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="startDate">Start Date</label>
                        <input type="date" class="form-control" id="startDate" required>
                    </div>
                    <div class="form-group">
                        <label for="endDate">End Date</label>
                        <input type="date" class="form-control" id="endDate" required>
                    </div>
                    <div class="form-group">
                        <label for="dueTime">Due Time</label>
                        <input type="time" class="form-control" id="dueTime" required>
                    </div>
                    <div class="form-group">
                        <label for="uploadImage">Upload Image</label>
                        <input type="file" class="form-control" id="uploadImage">
                    </div>
                    <div class="form-group">
                        <label for="uploadVideo">Upload Video</label>
                        <input type="file" class="form-control" id="uploadVideo">
                    </div>
                    <button type="submit" class="btn btn-primary">Create Task</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Modal for Task Details -->
<div class="modal fade" id="taskDetailModal" tabindex="-1" aria-labelledby="taskDetailModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="taskDetailModalLabel">Task Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="taskDetails"></div>
                <button id="updateTaskButton" class="btn btn-primary">Update Task</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script>
    let tasks = [];

    // Handle Task Creation
    $("#createTaskButton").on("click", function () {
        $("#taskModal").modal("show");
    });

    $("#taskForm").on("submit", function (e) {
        e.preventDefault();

        const project = $("#project").val();
        const assignedBy = $("#assignedBy").val();
        const assignedTo = $("#assignedTo").val();
        const taskDescription = $("#taskDescription").val();
        const priority = $("#priority").val();
        const status = $("#status").val();
        const startDate = $("#startDate").val();
        const endDate = $("#endDate").val();
        const dueTime = $("#dueTime").val();

        // Image and Video upload handling (optional)
        const imageFile = $("#uploadImage")[0].files[0];
        const videoFile = $("#uploadVideo")[0].files[0];

        const task = {
            project,
            assignedBy,
            assignedTo,
            taskDescription,
            priority,
            status,
            startDate,
            endDate,
            dueTime,
            imageFile,
            videoFile
        };

        tasks.push(task); // Store task in the tasks array

        const taskCard = `
                <div class="task-card" data-index="${tasks.length - 1}">
                    <strong>${project}</strong><br>
                    <span>${taskDescription}</span>
                </div>
            `;

        $(`#${status}`).append(taskCard);
        $("#taskModal").modal("hide");
        this.reset();
    });

    // Handle Task Card Click to Show Details
    $(document).on("click", ".task-card", function () {
        const index = $(this).data("index");
        const task = tasks[index];

        const taskDetails = `
                <strong>Project:</strong> ${task.project}<br>
                <strong>Assigned By:</strong> ${task.assignedBy}<br>
                <strong>Assigned To:</strong> ${task.assignedTo}<br>
                <strong>Description:</strong> ${task.taskDescription}<br>
                <strong>Priority:</strong> ${task.priority}<br>
                <strong>Status:</strong> ${task.status}<br>
                <strong>Start Date:</strong> ${task.startDate}<br>
                <strong>End Date:</strong> ${task.endDate}<br>
                <strong>Due Time:</strong> ${task.dueTime}<br>
                <strong>Image:</strong> ${task.imageFile ? task.imageFile.name : 'None'}<br>
                <strong>Video:</strong> ${task.videoFile ? task.videoFile.name : 'None'}<br>
            `;
        $("#taskDetails").html(taskDetails);
        $("#taskDetailModal").modal("show");
    });
</script>
